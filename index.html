<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="page-wrapper"> <!-- New wrapper div -->
        <div class="container">
            <h1>O-week 2025: 12 September (Day 3)</h1> <!-- Moved the title here -->
            <div class="inside-container">
                <div class="upper-panel">
                    <div class="onlineCoursePrizeSection">
                        <p style="font-size: 30px; color: #006eff; font-weight: bold;">Online Courses</p>
                        <p class="onlineCourseDisplayPrizeName"></p>
                        <p class="onlineCourseDisplayTagName"></p>
                        <button class="onlineCourselotteryButton">Pick a prize now!</button>
                    </div>
                    <div class="prizeCount">
                        <p>Prize remaining:</p>&nbsp;
                        <p class="onlineCoursetotalNumber"></p>
                    </div>
                    <button class="onlineCourseUndoButton">Undo</button> <!-- Add this button -->
                </div>

                <div class="lower-panel">
                    <div class="stampCollectionPrizeSection">
                        <p style="font-size: 30px; color: #4A90E2; font-weight: bold;">Stamp Collection</p>
                        <p class="stampCollectionDisplayPrizeName"></p>
                        <p class="stampCollectionDisplayTagName"></p>
                        <button class="stampCollectionlotteryButton">Pick a prize now!</button>
                    </div>
                    <div class="prizeCount">
                        <p>Prize remaining:</p>&nbsp;
                        <p class="stampCollectionTotalNumber"></p>
                    </div>
                    <button class="stampCollectionUndoButton">Undo</button> <!-- Add this button -->
                </div>
            </div>
        </div>
    </div>
    
    <script>
        //Add variable for large prize/middle prize to keep track of the total number
        let onlineCoursePrizeHistory = [];
        let stampCollectionPrizeHistory = [];
        
        let onlineCoursePrize = [
            { name: "Tote Bag", quantity: 1, tags: "Bags" }, // HKUL 111th anniversary Tote Bag
            { name: "Laptop Case", quantity: 2, tags: "Bags" },
            { name: "Tote Bag", quantity: 1, tags: "Bags" }, // Pokemon Tote Bag
            { name: "Pouch (Elsevier)", quantity: 1, tags: "Bags" },
            { name: "Small Bag (SAGE)", quantity: 1, tags: "Bags" },
            { name: "Tote Bag", quantity: 13, tags: "Bags" },
            { name: "Tote Bag", quantity: 1, tags: "Bags" }, // Zipper Tote Bag
            { name: "Insulate Bag", quantity: 1, tags: "Bags" },
            { name: "Tote Bag", quantity: 2, tags: "Bags" },
            { name: "Tote Bag", quantity: 1, tags: "Bags" },// IET Tote Bag

            { name: "Starbucks Coupons", quantity: 2, tags: "Coupons" },

            { name: "SAGE bunny plushie", quantity: 2, tags: "Dolls" },
            { name: "Cute Funny Handmade Vegetables", quantity: 9, tags: "Dolls" },
            { name: "Mouse plushie", quantity: 1, tags: "Dolls" },
            { name: "Rhino plushie", quantity: 1, tags: "Dolls" },
            { name: "Tiger plushie", quantity: 1, tags: "Dolls" },
            { name: "Cute pink dolphin plushie", quantity: 1, tags: "Dolls" },
            { name: "Blue owl plushie", quantity: 1, tags: "Dolls" },
            

            { name: "3 in 1 Data Cable", quantity: 1, tags: "Electronics" },
            { name: "3 in 1 Strectchable Data Cable", quantity: 1, tags: "Electronics" },
            { name: "HKTDC Wireless Charger", quantity: 1, tags: "Electronics" },
            { name: "LED digital display fan (purple)", quantity: 1, tags: "Electronics" },
            { name: "Mini LED Book Lamp", quantity: 2, tags: "Electronics" },
            { name: "Power Bank", quantity: 2, tags: "Electronics" },
            { name: "rabbit light", quantity: 6, tags: "Electronics" },
            { name: "USB", quantity: 1, tags: "Electronics" },
            { name: "USB Book Reading Light", quantity: 6, tags: "Electronics" },

            { name: "Cedars Coffee Mug", quantity: 1, tags: "Others" },
            { name: "Collapsible Coffee Cup", quantity: 1, tags: "Others" },
            { name: "Elsevier Cup Set", quantity: 1, tags: "Others" },
            { name: "East China Normal University Wooden Coasters (Set)", quantity: 2, tags: "Others" },
            { name: "Eslite Coupons", quantity: 11, tags: "Others" },
            { name: "Han Dynasty Style Backflow Fragrance Set", quantity: 1, tags: "Others" },
            { name: "HKU Music Library Wind Chimes", quantity: 1, tags: "Others" },
            { name: "Mobile Phone Holder", quantity: 13, tags: "Others" },
            { name: "Panda Lego", quantity: 18, tags: "Others" },
            { name: "Puzzle", quantity: 4, tags: "Others" },
            { name: "Relax Kuma Mug", quantity: 1, tags: "Others" },
            { name: "Towel", quantity: 4, tags: "Others" },
            { name: "(blank)", quantity: 1, tags: "Others" }, // Squeeze ball
            { name: "Folding Umbrella", quantity: 7, tags: "Others" }, // Folded Umbrella keyword

            { name: "Lucky package", quantity: 1, tags: "package" }, // CNKI Totebag + Blink Bottle
            { name: "Lucky package", quantity: 1, tags: "package" }, // Video Totebag + Creative Graphic Stickey Notes + 111 coasters + Cedars Notebook (medium)

            { name: "Notebook", quantity: 1, tags: "Stationery" }, // Fudan University Notebook
            { name: "Notebook", quantity: 1, tags: "Stationery" }, // HKUL 111th anniversary Notebook
            { name: "Metal Feather Bookmark + Notebook", quantity: 2, tags: "Stationery" },
            { name: "Notebook", quantity: 4, tags: "Stationery" }, // Notebook (3+1)
            { name: "Notebook", quantity: 5, tags: "Stationery" }, // Notebook (3+2)
            { name: "Notebook", quantity: 6, tags: "Stationery" }, // Notebook with Pen (3+3)
            { name: "Notebook", quantity: 1, tags: "Stationery" }, // OCLC Notebook & Pen
            { name: "Stationery set", quantity: 1, tags: "Stationery" },
            { name: "ad-lib cloth folder", quantity: 1, tags: "Stationery" }
        ]

        let stampCollectionPrize = [
            // Bags
            { name: "HYREAD Beverage Bag", quantity: 1, tags: "Bags" },
            { name: "Small Bag", quantity: 1, tags: "Bags" },
            { name: "HYREAD Cup Holder Bag", quantity: 2, tags: "Bags" },
            { name: "Eco-friendly Bag", quantity: 4, tags: "Bags" },
            { name: "Non-woven Bag", quantity: 1, tags: "Bags" },
            { name: "Non-woven Bag", quantity: 1, tags: "Bags" },
            { name: "Pouch", quantity: 3, tags: "Bags" },
            { name: "Small Drawstring Bag", quantity: 3, tags: "Bags" },
            { name: "Eco-friendly Bag", quantity: 2, tags: "Bags" }, // Small Eco-friendly Bag
            { name: "Small Bag", quantity: 1, tags: "Bags" },       // Small Hand Bag
            { name: "Pouch", quantity: 2, tags: "Bags" },           // Small Pouch
            { name: "Tote bag", quantity: 4, tags: "Bags" },
            { name: "Transparent mesh pencil case + pens", quantity: 30, tags: "Stationery" },    // Transparent mesh pencil case (120*200mm) + pens

            // Others
            { name: "Stress Ball", quantity: 2, tags: "Others" },   // Cedars Stress Ball
            { name: "Peking University Paper-cutting", quantity: 1, tags: "Others" },
            { name: "Plastic Coaster", quantity: 1, tags: "Others" },
            { name: "Coasters", quantity: 2, tags: "Others" },
            { name: "Magnet", quantity: 1, tags: "Others" },
            { name: "NUS Libraries glasses clothes", quantity: 1, tags: "Others" },

            // Stationery
            { name: "Cell Phone Holder", quantity: 7, tags: "Stationery" },
            { name: "East China Normal University Bookmark (Set)", quantity: 2, tags: "Stationery" },
            { name: "Memo", quantity: 1, tags: "Stationery" },      // HKUL 110th anniversary Memo
            { name: "Memo pad", quantity: 10, tags: "Stationery" },
            { name: "Notebook", quantity: 8, tags: "Stationery" },
            { name: "Paper tape", quantity: 2, tags: "Stationery" }, // Shanghai Library Paper tape
            { name: "Notebook", quantity: 3, tags: "Stationery" },   // Small Notebook (total 3)
            { name: "Notebook", quantity: 1, tags: "Stationery" },   // Small Notebook (1)
            { name: "Taiwan News Postcard", quantity: 1, tags: "Stationery" },
            { name: "Flocked Stickers", quantity: 1, tags: "Stationery" },
            { name: "Colorful tapes", quantity: 3, tags: "Stationery" },
            { name: "Bookmarks", quantity: 2, tags: "Stationery" },  // Metal feather Bookmark
            { name: "Bookmarks", quantity: 1, tags: "Stationery" },  // Bookmarks
            { name: "HKU Space Community College Staionery Set", quantity: 1, tags: "Stationery" },
            { name: "Key chain", quantity: 1, tags: "Stationery" },
            { name: "Key chain", quantity: 1, tags: "Stationery" },  // Eygypt Key Chain
            { name: "Bookmarks", quantity: 1, tags: "Stationery" },  // Tree University bookmarks
            { name: "Animal/Sushu Labels", quantity: 1, tags: "Stationery" }
        ]

        window.addEventListener("load", (event) => {
            // Only load from localStorage if the item exists
            if (localStorage.getItem("onlineCoursePrize")) {
                onlineCoursePrize = JSON.parse(localStorage.getItem("onlineCoursePrize"));
            }
            if (localStorage.getItem("stampCollectionPrize")) {
                stampCollectionPrize = JSON.parse(localStorage.getItem("stampCollectionPrize"));
            }
            
            showOnlineCoursePrizeTotalNumber();
            showStampCollectionPrizeTotalNumber();
        });

        const onlineCourselotteryButton = document.querySelector(".onlineCourselotteryButton");
        const onlineCourseDisplayPrizeName = document.querySelector(".onlineCourseDisplayPrizeName");
        const onlineCourseDisplayTagName = document.querySelector(".onlineCourseDisplayTagName");
        const onlineCoursetotalNumber = document.querySelector(".onlineCoursetotalNumber");
        const onlineCourseUndoButton = document.querySelector(".onlineCourseUndoButton");
        
        const stampCollectionDisplayPrizeName = document.querySelector(".stampCollectionDisplayPrizeName");
        const stampCollectionDisplayTagName = document.querySelector(".stampCollectionDisplayTagName");
        const stampCollectionlotteryButton = document.querySelector(".stampCollectionlotteryButton");
        const stampCollectionTotalNumber = document.querySelector(".stampCollectionTotalNumber");
        const stampCollectionUndoButton = document.querySelector(".stampCollectionUndoButton");

        // For online course prize
        function onlineCourseLottery() {
            onlineCourseDisplayPrizeName.textContent = "";
            onlineCourseDisplayTagName.textContent = "";

            setTimeout(() => {
                // Save the current state BEFORE changing it
                onlineCoursePrizeHistory.push(JSON.parse(JSON.stringify(onlineCoursePrize)));

                //Generate a random Number and find the prize
                let ranNum = getRandomIntInclusive(0, onlineCoursePrize.length-1);
                let prize = onlineCoursePrize[ranNum];

                //Display the prize name on the screen
                onlineCourseDisplayPrizeName.textContent = prize.name;
                console.log(onlineCoursePrize)
                onlineCourseDisplayTagName.textContent = `Tag: ${prize.tags}`;

                //Decrease the prize quantity by 1
                prize.quantity -= 1;
                
                //Check and remove the item that it's prize quantity is already zero
                onlineCoursePrize = onlineCoursePrize.filter(item => item.quantity > 0);

                showOnlineCoursePrizeTotalNumber();

                //Store the value to localStorage:
                localStorage.setItem("onlineCoursePrize", JSON.stringify(onlineCoursePrize));

                //enabled the button
                onlineCourselotteryButton.disabled = false;
            }, "1000");
        };

        function undoOnlineCourse() {
            if (onlineCoursePrizeHistory.length > 0) {
                onlineCoursePrize = onlineCoursePrizeHistory.pop();
                showOnlineCoursePrizeTotalNumber();
                onlineCourseDisplayPrizeName.textContent = "";
                onlineCourseDisplayTagName.textContent = "";
                localStorage.setItem("onlineCoursePrize", JSON.stringify(onlineCoursePrize));
            } else {
                alert("No more steps to undo!");
            }
        }

        onlineCourseUndoButton.addEventListener("click", undoOnlineCourse);

        function showOnlineCoursePrizeTotalNumber() {
            onlineCoursetotalNumber.textContent = calculateOnlineCoursePrizeTotalNumber();
        }

        function calculateOnlineCoursePrizeTotalNumber() {
            let sum = 0;
            for (const item of onlineCoursePrize) {
                sum += item.quantity;
            }
            return sum;
        }

        onlineCourselotteryButton.addEventListener("click", () => {
            onlineCourselotteryButton.disabled = true;
            onlineCourseLottery();
        });

        //For Stamp Collection Prize
        function stampCollectionPrizeLottery() {
            stampCollectionDisplayPrizeName.textContent = "";
            stampCollectionDisplayTagName.textContent = "";

            setTimeout(() => {
                stampCollectionPrizeHistory.push(JSON.parse(JSON.stringify(stampCollectionPrize)));

                let ranNum = getRandomIntInclusive(0, stampCollectionPrize.length-1);
                let prize = stampCollectionPrize[ranNum];
                
                stampCollectionDisplayPrizeName.textContent = prize.name;
                stampCollectionDisplayTagName.textContent = `Tag: ${prize.tags}`;

                prize.quantity -= 1;
                
                stampCollectionPrize = stampCollectionPrize.filter(item => item.quantity > 0);

                showStampCollectionPrizeTotalNumber();

                localStorage.setItem("stampCollectionPrize", JSON.stringify(stampCollectionPrize));

                stampCollectionlotteryButton.disabled = false;
            }, "1000");
        };

        function undoStampCollection() {
            if (stampCollectionPrizeHistory.length > 0) {
                stampCollectionPrize = stampCollectionPrizeHistory.pop();
                showStampCollectionPrizeTotalNumber();
                stampCollectionDisplayPrizeName.textContent = "";
                stampCollectionDisplayTagName.textContent = "";
                localStorage.setItem("stampCollectionPrize", JSON.stringify(stampCollectionPrize));
            } else {
                alert("No more steps to undo!");
            }
        }

        stampCollectionUndoButton.addEventListener("click", undoStampCollection);
                
        function showStampCollectionPrizeTotalNumber() {
            stampCollectionTotalNumber.textContent = calculateStampCollectionPrizeTotalNumber();
        }

        function calculateStampCollectionPrizeTotalNumber() {
            let sum = 0;
            for (const item of stampCollectionPrize) {
                sum += item.quantity;
            }
            return sum;
        }

        stampCollectionlotteryButton.addEventListener("click", () => {
            stampCollectionlotteryButton.disabled = true;
            stampCollectionPrizeLottery();
        });

        function getRandomIntInclusive(min, max) {
            const minCeiled = Math.ceil(min);
            const maxFloored = Math.floor(max);
            return Math.floor(Math.random() * (maxFloored - minCeiled + 1) + minCeiled);
        }
    </script>
</body>
</html>
